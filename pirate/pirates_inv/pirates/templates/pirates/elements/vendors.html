{%  extends 'pirates/dashboards/admin_dashboard.html' %}

{% block head %}
    <link rel="stylesheet" href="/static/pirates/css/vendors.css" />
{% endblock %}



{% block container %}
    <div class="container">
        <div class = "row">
            <div class="btn-group btn-group-lg"  role="group" id ="v_buttonGroup">
                <button type="button" class="btn btn-primary btn-sm " data-toggle="modal" data-target="#addDevice" id="v_new_button">New</button>
                <button type="button" class="btn btn-primary btn-sm btn-secondary" id="v_edit_button">Edit</button>
                <button type="button" class="btn btn-primary btn-sm btn-secondary" id="v_delete_button">Delete</button>
            </div>
        </div>
        <div class = "row" id="v_locCards">
        {% for vendor in vendorCount %}
                <div class="card col-md-3 mt-2 mr-1 bg-dark" style="width: 15rem;">
                    <img class="card-img-top" src="https://mdbootstrap.com/img/Photos/Others/images/43.jpg" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">{{vendor.device}} Vendors</h5>
                        <ul class = "list-group list-group-flush">
                            <button type="button" id = "{{vendor.device}}_Vendors" class="btn btn-outline-secondary"  data-toggle="modal" data-target="#{{vendor.device}}_view">
                                Unique Vendors: {{vendor.count}}
                            </button>
                        </ul>
                    </div>
                </div>
        {% endfor %}
        </div>
    </div>


<!-- Modal for Viewing Vendors for a Device -->
{% for v in vendors%}
    {% for type, list1 in v.items %}
    <div class="modal fade" id="{{type}}_view" tabindex="-1" role="dialog" aria-labelledby="{{type}}_view" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
        <div class="modal-content">

        <div class="modal-header" >
          <h5 class="modal-title" >{{type}} Vendors</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body"  id = 'modalBody'>
          <table class="table table-bordered  table-striped table-hover">
            <thead>
                <tr>
                  <th scope="col">Model</th>
                  <th scope="col">Vendor</th>
                  <th scope="col"># Bought</th>
                  <th scope="col">Purchase Date</th>
                  <th scope="col">Replacement Date</th>
                </tr>
            </thead>
            <tbody>
 {% for devices in list1 %} <!-- loop to iterate through # of models within a device type -->
    {% for info in devices %} <!-- loop to iterate through # of devices within a model -->

     <tr id="{{type}}_{{info.v_model}}_{{forloop.counter}}"
         onclick="editClass('{{info.v_type}}', '{{info.v_brand}}', '{{info.v_model}}',
                            '{{info.v_name}}', '{{info.v_qb}}', '{{info.v_pm}}', '{{info.v_py}}',
                            '{{info.v_rm}}', '{{info.v_ry}}', this.id);"

                data-dismiss="modal" data-toggle="modal"
                data-target="#addVendor">
         {% if forloop.counter == 1 %}
            <td id="{{type}}_{{info.v_model}}_{{forloop.counter}}_model"> {{info.v_model}} </td>
         {% else %}
            <td></td>
         {% endif %}

         <td id="{{type}}_{info.v_model}}_{{forloop.counter}}_vendor"> {{info.v_name}}</td>
         <td id="{{type}}_{{info.v_model}}_{{forloop.counter}}_quantity"> {{info.v_qb}} </td>
         <td id={{type}}_{{info.v_model}}_{{forloop.counter}}_"pd"> {{info.v_pm}}/{{info.v_py}}</td>
         <td id="{{type}}_{{info.v_model}}_{{forloop.counter}}_rd"> {{info.v_rm}}/{{info.v_ry}}</td>
     </tr>
 {% endfor %} <!-- Ends loop for # of devices within a model -->

    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
{% endfor %} <!-- Ends loop for # of models within Device Type -->
 </tbody>
</table>
    </div>
    <div class="modal-footer">
          <div class="float-left">
                <button id ='new_room' type="button" class="btn btn-success" onclick="editClass('{{buildings}}', this.id);" data-dismiss="modal" data-toggle="modal" data-target="#newLocationForm">New</button>
          </div>
          <div class="float-right">
              <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
          </div>
      </div>

    </div>
  </div>
</div>
{% endfor %} <!-- Ends loop for device types in district -->
{% endfor %} <!-- Ends loop to iterate through vendors on backend -->



<!-- New Vendor Form -->
<div class="modal fade" id="addVendor" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addVendorTitle">New Vendor</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
<form class="needs-validation" novalidate>
  <div class="form-row vendorEntry">
      <label for="deviceType">Device Type</label>
      <div class="col-md-12 mb-3" id="deviceType">
        <select  class="custom-select mr-sm-2" id="deviceHolder" >
            <option selected id ="selectedType"></option>
            {% for devices in vendors %}
                {% for deviceTypes in devices %}
                    <option  value="{{deviceTypes}}" id ="{{deviceTypes}}">{{deviceTypes}}</option>
                {% endfor %}
            {% endfor %}
        </select>
      </div>
    <div class="col-md-6 mb-3 vendorEntry">
      <label for="deviceBrand">Device Make/Brand</label>
      <input type="text" class="form-control" id="deviceBrand" placeholder="">
    </div>
    <div class="col-md-6 mb-3 vendorEntry">
      <label for="deviceModel">Device Model</label>
      <div class="input-group">
        <input type="text" class="form-control" id="deviceModel"  required>
      </div>
    </div>
  </div>
  <div class="form-row">
    <div class="col-md-6 mb-3 ">
      <label for="deviceVendor" class = 'vendorEntry'>Vendor</label>
      <input type="text" class="form-control" id="deviceVendor" placeholder="" required>
    </div>
    <div class="col-md-6 mb-3">
      <label for="quantityBought">Quantity Bought</label>
      <input type="number" class="form-control" id="quantityBought" placeholder="">
    </div>
  </div>
   <div class="form-row vendorEntry">
       <div class="col mb-3">
           <div class="form-group">
                <label for="purchaseDate">Purchase Date</label>
                <input type="month" class="form-control mirror" onkeyup="showDate()"  id="purchaseDate" placeholder="">
            </div>
       </div>
    </div>
    <div class="form-row vendorEntry">
         <div class="col mb-3">
           <div class="form-group">
                <label for="replacementDate">Anticipated Replacement Date</label>
                <input type="text" class="form-control mirror"  data-date-fromat="MMMM YYYY" id="replacementDate">
            </div>
         </div>
    </div>
    <button class="btn btn-primary" type="submit">Add Vendor</button>
</form>
       </div>
      </div>
     </div>
    </div>




<div class="modal"  id ="addDevice" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Track New Device</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="formGroupExampleInput">Device Type</label>
            <input type="text" class="form-control" id="formGroupExampleInput">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary">Update</button>
      </div>
    </div>
  </div>
</div>




{% endblock %}

{% block js %}

<script type="text/javascript" src="/static/pirates/js/vendor_edit.js"></script>
{% endblock js %}
